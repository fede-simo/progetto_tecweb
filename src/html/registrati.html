<!DOCTYPE html>
<html lang="it">

<head>
    <title>Registrati | Prophit</title> 
    <meta charset="UTF-8">
    <meta name="description" content="Registra il tuo account Prophit e partecipa ai corsi di finanza su crypto, azioni ed ETF!"> 
    <meta name="keywords" content="Prophit, registrazione, registrati, register, signup, area personale, area riservata">
    
    <link rel="stylesheet" href="../css/styles.css" media="screen">
    <!--<script src="../js/textAnimations.js" defer></script>-->
    <script src="../js/buttonsManager.js" defer></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    
    <script> /*da mettere in un file esterno*/

		/**
		 * chiave: nome dell'input che cerco
		 * [0]: Prima indicazione per la compilazione dell'input
		 * [1]: espressione regolare da controllare
		 * [2]: Hint nel caso in cui input fornito sia sbagliato
		**/

		var dettagli_form = { 
			"nome": ["Esempio: Mario",/^[a-zA-Z' ]{2,}$/,"Inserire un nome di lunghezza almeno 2. Non sono ammessi numeri."],
			"cognome": ["Esempio: Rossi",/^[a-zA-Z' ]{2,}$/,"Inserire un cognome di lunghezza almeno 2. Non sono ammessi numeri."],
            "dataNascita": ["",/^\d{4}-\d{2}-\d{2}$/,"Inserire una data corretta"],
			"nomeUtente": ["Esempio: Mario04",/^[a-zA-Z0-9]{2,}$/,"Inserire un nome utente di lunghezza almeno 2. Non sono ammessi spazi."],
            "password": ["Almeno 8 caratteri, 1 numero e 1 carattere speciale",/^(?=.*[A-Za-z])(?=.*\d)(?=.*[^A-Za-z0-9]).{8,}$/,"Inserire una password di almeno 8 caratteri, di cui almeno un numero e un carattere speciale."],
            "confermaPassword": ["",/^(?=.*[A-Za-z])(?=.*\d)(?=.*[^A-Za-z0-9]).{8,}$/,"Le password non coincidono."],
		};
		
		function caricamento() {
			for (var key in dettagli_form) {
				var input = document.getElementById(key);
				messaggio(input,0);
				input.onblur = function () {validazioneCampo(this);};
			}
			var node = document.getElementById('register-form');
			node.onsubmit = function () {
                return validazioneForm(this);
            };
		}
			
		function validazioneCampo(input) {		
			var regex = dettagli_form[input.id][1];
			var text = input.value;

			var p = input.parentNode;
			
			if (p.children[2]) {
				p.removeChild(p.children[2]);
			}

			if (text.search(regex)!=0) {
				messaggio(input, 1);
				//input.focus();	//puo essere fastidioso
				//input.select(); 	//non da usare sempre, specialmente nei campi lunghi
				return false;
			}

            if (input.id === "confermaPassword") {
                var password = document.getElementById("password").value;
                if (text !== password) {
                    messaggio(input, 1);
                    return false;
                }
            }

			return true;
		}
			
		function validazioneForm() {
			var errori = true;

			for (var key in dettagli_form) {

				var input = document.getElementById(key);
				errori = validazioneCampo(input) && errori;
			}
			return errori;
		}
			
		function messaggio(input, mode) {
		/* mode = 0, modalità input
		   mode = 1, modalità errore */

		   	var node;
		   	var p = input.parentNode;

		   	if (mode) {
				node = document.createElement('strong');
				node.className = 'errore';
				node.appendChild(document.createTextNode(dettagli_form[input.id][2]));	
		   	} else {
				node = document.createElement('span');
				node.className = 'suggerimento';
				node.appendChild(document.createTextNode(dettagli_form[input.id][0])); 
		   	}
			p.appendChild(node);
		
		}

	</script>
</head>
<body onload="caricamento();">
    <header>
        <h1>Prophit</h1>
        <nav id="menu" aria-label="Menù di navigazione">
            <ul>
                <li lang="en"><a href="index.php">Home</a></li>
                <li><a href="./chisiamo.html">Chi siamo</a></li>
                <li><a href="corsi.php">Corsi</a></li>
                <li lang="en"><a href="./news.html">News</a></li>
                <li><a href="./contatti.html">Contatti</a></li>
            </ul>
        </nav>
        <div>
            <!-- Checkbox da trasformare in icona per ricerca cliccabile che poi mostra casella di testo <input type="checkbox" id="search-checkbox" aria-label="Cerca"> -->
        </div>
    </header>   

    <main id="main">
        <!--<button id="back-to-top">&#8593</button> -->
        <nav id="breadcrumb">
            <p>Ti trovi in: <a href="./index.html" lang="en">Home</a> > Registrati </p>
        </nav>

        <!--{start-form-registrazione}-->

        <form id="register-form" name="register-form" action="/src/php/registrati.php" method="POST" autocomplete="on">
            <h1>Registrati su Prophit!</h1>

            <fieldset id="Dati personali">
                <legend>Dati personali</legend>      

                <div>
                    <label for="nome" class="register-label">Nome:</label>
                    <input type="text" name="nome" id="nome">
                </div>
                <div>
                    <label for="cognome">Cognome:</label>
                    <input type="text" name="cognome" id="cognome">
                </div>
                <div>
                    <label for="data_di_nascita">Data di nascita:</label>
                    <input type="date" name="data_di_nascita" id="data_di_nascita">
                </div>
            </fieldset>

            <fieldset id="Dati di accesso">
                <legend>Dati di accesso</legend>      

                <div>
                    <label for="username">Nome utente:</label>
                    <input type="text" name="username" id="username" autocomplete="username">
                </div>
                <div>
                    <label for="password" lang="en">Password:</label>
                    <input type="password" name="password" id="password" autocomplete="new-password">
                </div>
                <div>
                    <label for="confermaPassword">Conferma <span lang="en">password</span>:</label>
                    <input type="password" name="confermaPassword" id="confermaPassword" autocomplete="new-password">
                </div>
            </fieldset>            
            <div>
                <button type="submit" aria-label="Registrati su Prophit">Registrati</button>
                <button type="reset" aria-label="Pulisci campi form">Pulisci campi</button>
                <p class="login-link">Hai già un <span lang="en">account</span>? <a href="/src/php/accedi.php">Accedi</a></p>
            </div>
            <div class="errore-registrazione">
            <!--{start-errore-registrazione}-->

            <!--{end-errore-registrazione}-->
        </div>
            
        </form>

        
        
        
        <!--{end-form-registrazione}-->

        
        

    </main>

    <footer>
        
    </footer>
</body>
</html>
